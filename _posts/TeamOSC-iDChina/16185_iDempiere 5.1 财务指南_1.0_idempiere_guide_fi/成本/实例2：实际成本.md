实例2：实际成本
===

概述
---

http://johnny.blog.51cto.com/161381/56076/  ERP中的实际成本管理思路
http://www.itpub.net/forum.php?mod=viewthread&tid=1746001 移动平均成本下工单成本如何收集

Recalculating average costing backwardly
---

http://blog.goodwill.co.id/recalculating-average-costing-backwardly/
https://stackoverflow.com/questions/17691330/calculation-average-costing-using-with-recursive-sql-postgres-9-1

采购价差
---

http://www.docin.com/p-1721348088.html   浅谈ERP的移动平均价格
http://www.itpub.net/thread-132390-1-1.html  库存采用移动平均成本，为什么还会材料采购价格差异？

1. 负库存
2. 入库价格、发票价格差异
3. 退货（下例2）
3. 不规范操作（补单导致的负库存，见下例1，例3，看代码是先处理入库数还是出库数）

由于某些特殊的业务处理导致系统计算成本过程中产生了负库存（即使组织参数不允许负库存）导致产生成本差异，特殊情况举例如下：
1、采购接收
1月1日，物品A现有量10个，成本10元。
1月10日上午10:00，操作员A采购接收10个，成本20元。
1月10日上午10:01，操作员B补做1月9日的出库业务，出库15个。
由于成本管理器一般设定为5分钟运行一次，系统处理成本计算时会先处理15个出库业务，从而导致5个的负库存。相关分录如下：
出库15个：
借：XX费用    150
贷：库存     150   (处理完该业务后该物品库存总成本-50)

接收10个：
借：库存        150
差异        50    (抵消上次产生的负库存50)
贷：材料采购   200

2、退货给供应商
1月1日，采购物品B，数量10个，单价10元。
到了1月10日，发现该批物品有问题要退货给供应商。但是此时库存现有量只有10个，且单价为5元。
则退货分录如下：
借：材料采购    100
贷：库存                 50
差异                 50

3、组织间转移
1月1日，物品C现有量10个，成本10元。
1月10日上午10:00，从别的库存中组织间转移过来10个，成本20元。
1月10日上午10:01，出库15个
由于成本管理器一般设定为5分钟运行一次，系统处理成本计算时会先处理15个出库业务，从而导致5个的负库存。相关分录如下：
出库15个：
借：XX费用    150
贷：库存     150   (处理完该业务后该物品库存总成本-50)
接收10个：
借：库存        150
差异        50    (抵消上次产生的负库存50)
贷：公司间   200

虽然系统参数不允许负库存，但是通过某些特定的操作会导致成本计算过程中产生负库存，所以会产生这些成本差异科目。

解决方法：
这是由于客户操作产生的差异，系统本身没有问题，所以要从客户操作上规范。比如当天库存业务当天做完可以大大减少这类现象的产生。
对于已经产生的成本差异，建议采用平均成本更新的方式来调整。首先通过“事务处理”->“物料分配”查询每个物品的成本差异。然后在“成本”->“平均成本更新”中进行成本更新，调整帐户选择原来的成本差异科目。

计算方法--捷诚软件
---

对于零售企业来说，随着行业的发展和进步，目前采用的成本核算方法主要有先进先出、最后进价、移动平均三种方法。捷诚商业管理信息系统（以下简称捷诚）目前支持的成本核算方法也正是这三种方法。针对与不同的管理目的和管理习惯商场可以采用相应的成本计算方法。 

在介绍的成本核算方法和计算公式之前我们首先明确进价与成本的关系，商品的成本与进价既有联系又有区别，商品的成本是根据商品的进价计算得出的，计算方法就是成本计算方法，一个商品在同一时间可以根据供应商等采购信息的区别而存在不同的进价，却只能有一个成本，成本随着进价的变化并根据不同的成本计算方法而发生相应的变化。另外当一个商品的销售按一定顺序与验收单的进货对应，我们称之为勾对；当商品的销售找不到验收单对应进货，则称为未勾对销售，反之，当验收单的进货，未与销售对应时则称为未勾对进货。       

无论成本计算方法如何变化，系统的计算必须遵循“历史进货进价总额-转出成本总额=当前库存金额”这一基本原则，只要符合，我们就认为该种方法是合理的，才能适用方法，否则，如成本计算方法本身不合理，则谈不上方法的适用。 

明白了上面两个关系后，下面我们介绍一下捷诚中的成本核算方法和计算公式。（注：以下所有所说金额均为含税进价金额，商品验收数量均为包括赠品的验收数量） 

一、移动平均 
商品验收单审核后，如果该商品在验收之前库存为0，那么“成本=商品验收金额/商品验收数量”；商品验收单审核后，如果该商品在验收之前库存不为0，那么
“成本=（商品库存金额+商品验收金额）/（商品库存数量+验收数量）”       
商品退货单审核后，如果退货后商品库存大于0，那么
“成本=（商品库存金额-商品退货金额）/（商品库存数量-退货数量）”；
商品退货单审核后，如果退货后商品库存小于等于0，那么成本保持不变。每日日结中判断商品库存是否小于0，如小于0则成本对应到该商品的最后进价。从上面的方法可看出除非库存为0，否则移动平均计算下是不会产生提价金额的。

二、最后进价
验收单审核后，成本=商品最后一次验收的进价，最后进价法下有关的帐务处理：  
（1） 存货收入时，按实际数量、单价及金额入帐，分录略。  
（2）登记进价差异。设置“库存商品”明细帐进价差异帐户，贷方登记贷差及借差的转销数，借方登记借差及贷差的转销数，期末无余额。每次进价变动时均计算进价差异。  

物价上涨时，（如3日进货），    
借：库存商品――A商品 500    
贷：库存商品――A商品进价差异 500  
此笔分录表示期初结存的100件，每件可能要取得5元的收益。   
 
物价下跌时，（如10日/15日进货）  
借：库存商品――A 商品进价差异1770（1380）    
贷：库存商品――A商品 1770（1380） 
此笔分录表示5日结存为295件，每件可能要损失6元（15－9）；
10日结存的345件， 每件可能要损失4元（9－5）。

月末一次计算。  
借：库存商品――A商品进价差异 2700    
贷：库存商品――A商品 2700  
此笔分录表示A商品在该月内因价格变动可能总共要损失2700元。 

 （3）结转销货成本。    
每次发货时结转。    
5日
借：商品销售成本 75      
贷：库存商品――A商品 75    

25日
借：商品销售成本 50      
贷：库存商品――A商品 50   

月末一次结转时，
借：商品销售成本 125   
贷：库存商品――A商品 125 

（4）月末一次结转进价差异， 
借：商品销售成本 2650（2700）  
贷：库存商品――A商品进价差异2650（2700） 
2650元为每次进价变动时计算的进价差异累计数，而2700元为月末一次计算的进价差异累计数。

三、先进先出 
在每天日结后更新一次成本价，如没有未勾对销售则按当天商品出货金额计算，如存在未勾对销售，那么该部分销售成本按最后进价计算成本。待验收单补上后按实际出货金额与当时销售成本差额产生提价金额。除非商品存在负库存，否则先进先出法不会产生提价金额。 
 
这三种成本核算方法各有优势和弊端，要根据不同的管理目的和情况适用正确的核算方法，根据国家规定同一企业在同一会计年度内只能采用一种成本核算方法，如想改变，只能在会计年度结束后经相关机构批准才能改变成本核算方法，所以用户在选择成本核算方法之前应充分与相关负责部门进行沟通。      

下面简单介绍一下三种成本核算方法的特点，并且概括地根据特点说明方法的适用范围； 
一、先进先出 
先进先出法的优势在于，商品的成本最接近商品的原始真实进货价，与供应商的结算金额基本一致，但如果商场商品进价频繁变动以及由于验收单据不能及时录入造成商品库存发生负数情况时，就会体现出该方法计算的成本变化相对滞后，而且库存金额无法及时反映由于市场进价变动而发生的变化。 

一般来说，一些高档百货的零售企业由于商品进价变化不大，而且补货机会相对较少，受市场变化影响小，并不急于上架销售，那么经营者管理目的大多注重于成本反映商品的原始价格，比较适合使用这种方法。 

二、最后进价 
相比其他两种方法，最后进价法具有如下特性： 
（一）科学性。市场经济条件下，物价随时都在涨跌。采用最后进价法既可使企业期末存货成本与市价最接近，期末存货成本的确定更为现实；又可使现行收入与现行成本相配比，防止物价上涨时发生利润高估、超额分配的现象。最后进价法的突出优点是它能提供管理层所需要的价格变动及其可能带来的收益或损失信息。其他存货计价方法下，我们虽然能感觉价格变动可能给企业带来收益或损失，但帐面上并没有反映收益或损失的金额，更没有反映物价连续变动的综合效果。价格涨跌并不是直线的，有些商品可能涨价，其他商品却可能是跌价的；同种商品在今日可能是涨价的，但在其他时间可能又是跌价的。采用最后进价法，通过设置“库存商品”明细帐的进价差异栏目，可以随时反映各种、各类、各部门全部商品的进价差异，便于管理层对本企业存货进行管理。管理层若想了解某商品因涨跌价而可能带来的收益或损失，只要查看此栏目就可一目了然。     

（二）简便性。若采用月末一次计算进价差异及结转销货成本，最后进价法相当简便。系统在每天计算并汇总进价差异，月末结转销货成本时可以自动完成月末进价差异的结转；可以随时显示或输出某种、某类、某部门及全部存货帐户的数量和金额。最后进价法只需在“库存商品”明细帐增加一个进价差异栏目即可，也可以在进价差异栏目增加一借一贷两个小栏目，帐簿设置不会复杂。     

（三）及时性。正因为可以随时结转销货成本及汇总进价差异，最新进价法不会受到及时性的困挠。由于每次商品进货价如发生变动都会产生提价金额，这种转出成本我们可以认为是提前转出的毛利金额，而在报表中反映的销售毛利实际上没有考虑到这一点，基于以上的特性，最后进价适用于存货额较大而且商品的进价受市场影响经常会发生变化的零售企业，比如一些大型的具备配送系统的零售企业如沃尔玛和家乐福都是采用该方法进行成本计算。
  
三、移动平均 
相比前两种方法，移动平均法的成本相对合理，从长期看也可反映企业由于进价变动带来的库存成本发生的变动，但成本一直在一定范围内波动，永远无法体现真实的成本，另外由于进价发生变动对库存产生影响反映的金额相比最后进价也不够及时准确，离市值仍然存在一定差异。一般来说适用于，对库存受市场影响产生变动，要求不高，并注重于毛利的准确性的一些超市和卖场。       

对于企业来说，选择哪种成本核算方法最好，主要看企业所在的角度（包括价值、纳税和现金流量、管理人员业绩评估等多个角度）、考虑的主要因素，另外还要看企业所经营存货的特点和财产物资的盘存制度以及物价变动情况等，适合企业的存货计价方法才是最好的计价方法，企业才会从中受益。所以企业必须全面考虑，扬长避短，选择最适合企业的存货计价方法。    

作为工程实施人员应尽量多学习相关知识，并充分地向用户讲解捷诚中成本计算的方法，协助企业找到最佳的成本计算方法，而不是代替用户去决定成本计算方法。

计算实例
---

案例1：某A股份有限公司2003年10月甲商品购入、销售和结存的有关数据如下：

10月  1日月初结存   600件      单价50元
10月  2日购入          600件      单价60元
10月  5日 销售         600件
10月15日购入        1200件   单价62.5元
10月16日销售          900件    
10月28日购入          300件     单价70元
10月31日月末结存  1200件 

1.存货发出计价方法：加权平均法

本期发出存货成本＝60×（600＋900）＝90000
期末库存存货成本＝60×1200＝72000
加权平均单位成本＝(600×50＋600×60＋1200×62.5+300×70)/(600＋600+1200+300) = 60元／件                     

2.存货发出计价方法：移动加权平均法

•10月2日购货后的加权平均单位成本＝(600×50＋600×60)/ (600+600)=55元/件
•10月5日发出存货成本=600×55＝33000元
•10月15日购货后的加权平均单位成本＝(600×55＋1200×62.5)/(600+1200)=60元／件
•10月16日发出存货成本＝900×60＝54000元
•10月28日购货后的加权平均单位成本＝(900×60＋300×70)/(900＋300)=62.5元／件
期末库存存货成本＝1200×62.5＝75000元
本期发出存货成本＝33000+54000 = 87000元

3.存货发出计价方法：先进先出法

期末库存存货的成本：＝300×700＋900×62.5=77250
本期发出存货成本：   ＝600×50＋600×60＋300×62.5=84750

4.存货发出计价方法：后进先出法

期末库存存货成本：＝600×50＋300×62.5+300×70＝69750
本期发出存货成本：＝600×60＋900×62.5=92250       

5.存货发出计价方法：毛利率法
毛利率法是根据本期销售净额乘以前期实际（或本月计划）毛利率匡算本期销售毛利，并计算发出存货成本的一种方法。
（1）基本作法及计算公式
毛利率=销售毛利/销售净额×100%
销售净额=商品销售收入-销售退回与折让
销售成本=销售净额-销售毛利=销售净额×（1-毛利率）
期末库存存货成本=期初存货成本+本期购货成本-本期销售成本
（2）评价：零售企业较为常见，计算手续比较简单      
 
6.存货发出计价方法：零售价法
零售价法是指用成本占零售价的百分比计算期末存货成本的一种方法，其基本做法：

①期初存货和本期存货同时按成本和零售价记录，以便计算可供销售的存货成本和售价总额；
②本期销售只按售价记录，从本期可供销售的存货售价总额中减去本期销售的售价总额，计算出期末存货的售价总额；
③计算存货成本占零售价的百分比，即成本率，公式为：
成本率=（期初存货成本+本期购货成本）/（期初存货售价+本期购货售价）× 100%
④计算期末存货成本，公式为：期末存货售价总额×成本率
⑤计算本期销售成本，公式为：期初存货成本+本期购货成本-期末存货成本
评价：主要适用于商品零售企业，因为这类企业的商品都要标明零售价，而商品的型号、品种、款式繁多，难于采用其他方法计价。

 | 单位成本 | 发出成本 | 期末成本 | 备注 | 
---|---|---|---|---|
加权平均 | 60 | 90000 | 72000 |  | 
移动加权平均 | 55-62.5 | 87000 | 75000 |  | 
先进先出 |  | 84750 | 77250 |  | 
后进先出 |  | 92250 | 69750 |  | 

