实例1：支付宝
===

概述
---

参考：http://www.cnblogs.com/blodfox777/archive/2009/11/03/1595223.html

用户经常在taobao采购或者jd采购，需要系统提供在线支付、往来对账功能。具体需求如下：
1. 支付宝帐号
2. 支付宝收款
3. 支付宝付款
4. 支付宝对账

系统需要与支付宝开放平台交换数据
1. 申请一个“开发者应用ID”，地址为http://open.alipay.com。
登录后，在“开放平台密钥”管理里面查找自己的appID和key，如下图：
![支付宝app_id](http://img01.taobaocdn.com/top/i1/LB1yfCxLFXXXXbWXVXXXXXXXXXX)

2. 申请相应的接口权限
https://doc.open.alipay.com/doc2/detail.htm?treeId=44&articleId=104064&docType=1

![支付宝支付（条码/声波）](http://static.oschina.net/uploads/space/2016/0519/193437_exlg_2720480.jpg)

支付宝帐号
---

- 系统内新建“支付宝银行”
- 下设不同的支付宝帐号

支付宝收款
---

- 系统外生成支付链接，支付宝完成后续收款过程。
- 系统内必须有相应的支付宝帐户。
系统内收款做单可以根据销售记录批量导入，再与支付宝进行对账即可。

支付宝付款
---

支付宝支付有二种情况：
1. 使用“帐号”和“交易金额”，直接转账。
2. 使用离线“当面付”技术，商家读取用户的声波/二维码后，提交支付宝交易。
3. 使用手机客户端扫描商品条码，用户确认支付。

从实际应用来讲，用户一般用支付宝客户端或者手机客户端支付，直接转账意义不大。
系统内付款做单可以根据销售记录批量导入，再与支付宝进行对账即可。

支付宝对账
---

对账需要：
1. 定制对账单导入格式
【系统管理】-【数据】-【数据导入】-【对账单格式】，根据csv格式修改支付宝对账单。
或者在银行下面添加【对账单加载器】，编写自己的java类处理支付宝对账单服务器数据。然后通过自动过程导入。

2. 下载支付宝对账单
支付宝开放平台提供“财务API”接口，链接如下：
https://doc.open.alipay.com/doc2/apiList.htm?spm=a219a.7629065.0.0.2kMXOU&cid=15&docType=4
用户下载到对账单后，解压缩后，即可导入。

